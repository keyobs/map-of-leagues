import{j as e,r as c,a as P}from"./react-3623596c.js";import{c as B}from"./react-dom-775a50b8.js";import{N as g,H as F}from"./react-router-dom-ab470f2c.js";import{i as I,t as m}from"./i18next-44214ecc.js";import{B as O}from"./i18next-browser-languagedetector-2400c0b9.js";import{i as q,u as k}from"./react-i18next-6b4d967f.js";import{C as U,A as H}from"./@ant-design-29962be8.js";import{u as Q,Q as W,a as $}from"./react-query-da9c9a81.js";import{l as z}from"./lodash-98b961eb.js";import{I as M,T as L,A as Z,B as V}from"./@mui-4675d9a8.js";import{M as G,a as J,P as K,T as X,Z as Y}from"./react-leaflet-828170a9.js";import{d as ee,e as h}from"./react-router-9704f0ea.js";import"./scheduler-04ce0582.js";import"./@remix-run-88f74c5a.js";import"./@babel-d780d8f7.js";import"./classnames-7e4e529b.js";import"./@ctrl-182969db.js";import"./rc-util-44c70940.js";import"./clsx-1229b3e0.js";import"./react-transition-group-cae3e55c.js";import"./@emotion-5fd882c4.js";import"./hoist-non-react-statics-d23de475.js";import"./react-is-3e8633c1.js";import"./stylis-581c9ed0.js";import"./@popperjs-0e7ee0a2.js";import"./leaflet-12ffd7f0.js";import"./@react-leaflet-ca384506.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function i(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=i(o);fetch(o.href,n)}})();const te={tag:" roller derby around the world",league_form_title:"Add a league",league_form_field_label_name:"leaguee",league_form_field_label_name_error_message:"Specify a league name.",league_form_field_label_city:"city",league_form_field_label_name_error_city:"Indicate a city.",league_form_button_submit:"Create this league",about_title:"About",about_teaser_title:"League of Map, what's that?",about_teaser:`League of Map is a web app project for Roller Derby leagues. It will enable
    each League to create its own profile with its own presentation. They will be able to publish their means
    and present its teams. Each league will be represented on an interactive map
    interactive map, allowing visitors to access this information sheet.`,about_dev_state:"League of Map is still in development phase.",about_external_help:"With help !",about_disclaimer:"This site is a personal project, it is not affiliated with WFTDA, MRDA or JRDA.",about_last_contribution:"Last update:"},ae={tag:"el roller derby en el mundo",league_form_title:"Añadir una ligua",league_form_field_label_name:"nombre de la ligua",league_form_field_label_name_error_message:"Especificar un nombre de liga",league_form_field_label_city:"ciudad",league_form_field_label_name_error_city:"Indicar una ciudad",league_form_button_submit:"Crear esta liga",about_title:"About",about_teaser_title:"League of Map, que es eso?",about_teaser:`League of Map es un proyecto de aplicación web dirigido a los ligas de roller derby. Permitirá
    cada Liga crear su propio perfil con su propia presentación. Podrá publicar sus medios
    y presentar a sus equipos. Cada Liga estará representada en un mapa interactivo
    que permitirá a los visitantes acceder a esta ficha de información.`,about_dev_state:"League of Map aún está en fase de desarrollo",about_external_help:"Con ayuda !",about_disclaimer:"Este sitio es un proyecto personal, no está afiliado a WFTDA, MRDA o JRDA",about_last_contribution:"Última actualización:"},oe={tag:"le roller derby dans le monde",map_cockpit_button_add_new_league:"Créer une league",league_form_title:"Ajouter une ligue",league_form_field_label_name:"nom de la league",league_form_field_label_name_error_message:"Préciser un nom de league",league_form_field_label_city:"ville",league_form_field_label_name_error_city:"Préciser une ville",league_form_button_submit:"Créer cette league",about_title:"À propos",about_teaser_title:"League of Map, c'est quoi ?",about_teaser:`League of Map est un projet de web app à destination des leagues de Roller Derby. Il permettra à
    chaque Ligue de créer sa fiche avec sa présentation. Elle pourra publier ses moyens
    de contact et présenter ses équipes. Chaque Ligue sera représentée sur une carte
    interactive qui permettra aux visiteurs d'accèder à cette fiche d'information.`,about_dev_state:"League of Map est en cours de développement.",about_external_help:"Avec de l'aide !",about_disclaimer:"Ce site est un projet personnel, il n'est pas affilié à la WFTDA, la MRDA ou la JRDA.",about_last_contribution:"Dernière mise à jour:"},re={en:{translation:te},fr:{translation:oe},es:{translation:ae}};I.use(q).use(O).init({compatibilityJSON:"v3",debug:!1,resources:re,fallbackLng:"en"});const ne=()=>{const t=a=>a?"navLinkActive":"navLink";return e.jsx("div",{className:"navBar",children:e.jsxs("div",{className:"navBarContainer",children:[e.jsx("br",{}),e.jsx(g,{className:({isActive:a})=>t(a),to:"/",children:"The Map"})," "," | ",e.jsx(g,{to:"/about",className:({isActive:a})=>t(a),children:"About"})," "," | ",e.jsx(g,{to:"/login",className:({isActive:a})=>t(a),children:"Login"}),e.jsx("br",{})]})})};const ie=[{id:"0001",name:"RD Nice",lat:43.710175,lon:7.261953,geoapifyId:"5104238a24d5121d40593dcca843b8d94540f00101f9017498020000000000c00208"},{id:"0002",name:"RD Bordeaux",lat:44.837788,lon:-.57918,geoapifyId:"5198aa0f7fa88fe2bf59efc9c342ad6b4640f00101f901369b010000000000c00207"},{id:"0003",name:"RD Munich",lat:48.135124,lon:11.581981,geoapifyId:"51ac66e77e9826274059f9426dc08c114840f00101f901dcf3000000000000c00208"},{id:"0004",name:"RD Brest",lat:48.38987,lon:-4.48718,geoapifyId:"51d745764aacf111c059cc54d2d4fc314840f00101f9019c6b100000000000c00207"},{id:"0005",name:"RD Madrid",lat:40.4167,lon:-3.7167,geoapifyId:"51a94d9cdcefa00dc059744b619456354440f00101f901c047510000000000c00208"},{id:"0006",name:"RD Hull",lat:42.2861,lon:-70.8835,geoapifyId:"51d423b2b4f8b9d5bf597e9bb45f2ddf4a40f00103f901666d970100000000c0020792030448756c6c"},{id:"0007",name:"RD Bergame",lat:45.695,lon:9.67,geoapifyId:"5169f7f58df95623405967dfcb33e5d84640f00101f90171b2000000000000c00208"}];function se(t){const a=Object.entries(t).flatMap(le).filter(ce).map(ue);return a.length!==0?"?"+a.join("&"):""}function le([t,a]){return Array.isArray(a)?a.map(i=>[t,i]):[[t,a]]}function ce([,t]){return["string","number","boolean"].includes(typeof t)}function ue([t,a]){return a==null?"":`${encodeURIComponent(t)}=${encodeURIComponent(a)}`}async function de(t){const{text:a}=t,o="https://api.geoapify.com/v1/geocode/autocomplete"+se({apiKey:"7397b2a78025469fbab3271aed88f907",text:a,type:"city",lang:"fr",format:"json"});return await(await fetch(o)).json()}function C(t){const{name:a,lat:i,lon:s}=t,o=[];return a===""&&o.push("leagueName"),(i==null||s==null)&&o.push("leagueLocation"),o}const A={placeId:"",label:"",city:""},pe=t=>{const{isOpen:a,onClose:i,addMarker:s}=t,[o,n]=c.useState(!1),[d,x]=c.useState(""),[u,f]=c.useState(A),[_,y]=c.useState(null),p=Q(["cities",u],()=>S({text:u.city}),{enabled:u.city!=null&&u.city.length>2}),w=c.useCallback(r=>{if(p.data!=null)return p.data.results.find(l=>l.place_id===r)},[p.data]),R=r=>{f(r===null?{placeId:"",label:"",city:""}:l=>({...l,label:r,city:r}))},N=r=>{if(r==null)f({placeId:"",label:"",city:""}),y(null);else{f(r);const l=w(r.placeId);y(l!==void 0?l:null)}},S=r=>{if(r.text.length>0)return de(r)},D=c.useCallback(z.debounce(()=>p.refetch(),500),[]);c.useEffect(()=>{D()},[u]);const E=c.useMemo(()=>p.data?[...u.placeId===""?[u]:[],...p.data.results.map(l=>({placeId:l.place_id,label:l.formatted,city:l.city}))]:[],[p.data,u]);function j(r){return{id:"",name:d,geoapifyId:u.placeId,lat:r==null?void 0:r.lat,lon:r==null?void 0:r.lon}}const b=c.useMemo(()=>o?C(j(_)):[],[d,u,_,o]);function T(){if(o||n(!0),p.data!=null&&b.length===0){const r=j(_);C(r).length===0&&(s(r),v())}}function v(){x(""),f(A),n(!1),i()}return e.jsxs("div",{className:"leagueDrawer",children:[e.jsxs("div",{className:"formHeader",children:[e.jsx("header",{children:m("league_form_title")}),e.jsx(M,{onClick:v,children:e.jsx(U,{style:{color:"aliceblue",marginRight:"10px"},rev:""})})]}),e.jsxs("form",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsx(L,{id:"name",className:"textField",label:m("league_form_field_label_name"),value:d,onChange:r=>x(r.target.value),InputLabelProps:{shrink:!0},error:b.includes("leagueName"),helperText:b.includes("leagueName")&&m("league_form_field_label_name_error_message")}),e.jsx(Z,{id:"city_autocomplete",options:E,getOptionLabel:r=>r.label,value:u,isOptionEqualToValue:(r,l)=>r.placeId===l.placeId,onInputChange:(r,l)=>R(l),onChange:(r,l)=>N(l),renderInput:r=>e.jsx(L,{...r,label:m("league_form_field_label_city"),error:b.includes("leagueLocation"),helperText:b.includes("leagueLocation")&&m("league_form_field_label_name_error_city")})})]}),e.jsx("div",{className:"actions",children:e.jsx(V,{variant:"contained",onClick:T,sx:{background:"#101035"},children:e.jsx("span",{children:m("league_form_button_submit")})})})]})},me=t=>{k();const{addMarker:a}=t,[i,s]=c.useState(!1),o=()=>{s(!i)};return e.jsxs("div",{className:"cockpitContainer",children:[e.jsx("div",{className:"cockpit",children:e.jsx(M,{onClick:()=>o(),children:e.jsx(H,{style:{fontSize:"34px",color:"aliceblue"},rev:void 0})})}),e.jsx("div",{className:`drawer ${i?"visible":"hidden"}`,children:e.jsx(pe,{addMarker:a,isOpen:i,onClose:()=>s(!1)})})]})},fe=()=>{const{markersList:t,addMarker:a}=_e();return e.jsxs("div",{className:"theMap",children:[e.jsx(me,{addMarker:a}),e.jsx("div",{className:"leafletContainer",children:e.jsx(be,{markersList:t})})]})},be=t=>{const{markersList:a}=t,[i,s]=c.useState(null);return e.jsxs(G,{center:[47.4,7.7],zoom:5,scrollWheelZoom:!0,zoomControl:!1,children:[a.map(o=>e.jsx(J,{position:[o.lat,o.lon],eventHandlers:{click:()=>{s(o.id)}},children:e.jsx(K,{children:o.name})},o.id)),e.jsx(X,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),e.jsx(Y,{position:"bottomright"})]})};function _e(){const[t,a]=c.useState([...ie]);return{markersList:t,addMarker:s=>{console.log("addMarker",s);const o={...s,id:ge(t.reverse()[0].id)};a(n=>[...n,o])}}}function ge(t){return(parseInt(t,10)+1).toString().padStart(4,"0")}async function he(){return(await(await fetch("https://api.github.com/repos/keyobs/map-of-leagues/commits?branch=main",{headers:{Authorization:"token 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","X-GitHub-Api-Version":"2022-11-28"}})).json())[0].commit.author.date}const xe=()=>{const{t}=k(),a=I.language,[i,s]=c.useState(null);c.useEffect(()=>{async function n(){he().then(d=>{s(d)})}n()},[]);const o=i?new Intl.DateTimeFormat(a,{dateStyle:"medium"}).format(new Date(i)):"n/a";return e.jsxs("div",{className:"about",children:[e.jsx("h3",{children:t("about_teaser_title")}),e.jsx("p",{children:t("about_teaser")}),e.jsx("h3",{children:"Techs"}),t("about_dev_state")," ",e.jsx("br",{}),t("about_last_contribution")," : ",o," ",e.jsx("br",{}),e.jsxs("p",{children:[e.jsx("b",{children:"Front"})," ",e.jsx("br",{}),"React + typescript ",e.jsx("br",{}),"TanStack Query ",e.jsx("br",{}),e.jsx("br",{}),e.jsx("b",{children:"Back"})," ",e.jsx("br",{}),e.jsx("i",{children:"... to be continued"})," ",e.jsx("br",{})]}),e.jsxs("p",{children:[e.jsx("b",{children:t("about_external_help")}),e.jsx("br",{}),"external api :"," ",e.jsx("a",{href:"https://www.geoapify.com/",target:"_blank",children:"geoapify"})]}),e.jsx("span",{children:e.jsx("i",{children:t("about_disclaimer")})})]})},ye=()=>e.jsx("div",{children:"Login"}),je=new W;function ve(){return e.jsx($,{client:je,children:e.jsxs("div",{className:"app",children:[e.jsx(ne,{}),e.jsx(Le,{})]})})}const Le=()=>e.jsxs(ee,{children:[e.jsx(h,{path:"/",element:e.jsx(fe,{})}),e.jsx(h,{path:"about",element:e.jsx(xe,{})}),e.jsx(h,{path:"login",element:e.jsx(ye,{})})]});B.createRoot(document.getElementById("root")).render(e.jsx(P.StrictMode,{children:e.jsx(F,{children:e.jsx(ve,{})})}));
